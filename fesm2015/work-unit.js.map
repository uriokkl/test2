{"version":3,"file":"work-unit.js","sources":["../../../projects/work-unit/src/lib/work-unit.service.ts","../../../projects/work-unit/src/lib/work-unit.component.ts","../../../projects/work-unit/src/lib/work-unit.module.ts","../../../projects/work-unit/src/public-api.ts","../../../projects/work-unit/src/work-unit.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WorkUnitService {\n\n  constructor() { }\n}\n","import { Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\n\nimport WebMap from \"@arcgis/core/WebMap\";\nimport MapView from \"@arcgis/core/views/MapView\";\nimport FeatureLayer from \"@arcgis/core/layers/FeatureLayer\";\nimport Basemap from \"@arcgis/core/Basemap\";\nimport LabelClass from \"@arcgis/core/layers/support/LabelClass\";\nimport { SimpleFillSymbol, SimpleLineSymbol, TextSymbol } from '@arcgis/core/symbols';\nimport Color from '@arcgis/core/Color';\nimport SimpleRenderer from '@arcgis/core/renderers/SimpleRenderer';\n\n@Component({\n  selector: 'lib-workUnit',\n  template: `\n  aaaa12345678\n  <div #mapViewNode style=\"width:400px;height: 400px;background-color:yellow\"></div>\nzzzz\n  `,\n  styles: [\n  ]\n})\nexport class WorkUnitComponent implements OnInit {\n\n  @ViewChild('mapViewNode', { static: true }) set content(content: ElementRef) {\n    if (content) { this.mapViewEl = content; }\n  }\n  @Output() mapLoaded = new EventEmitter<boolean>();\n  private mapViewEl!: ElementRef;\n  private _workUnits: string[] = [];\n  @Input() objectId: string;\n  private _z: string=\"z\";\n  @Input()\n  set zz(zzz: string)\n  {\n    var azzzzzz=this.objectId;\nthis._z=zzz;\n  }\n  get zz()\n  {\n    \n    return this._z;\n  }\n  \n  @Input()\n  set workUnits(workUnits: string[]) {\n    this._workUnits = workUnits;\n\n    const WorkUnitsWhere = workUnits.map(\n      workUnit => \n      \"'\" + workUnit + \"'\"\n      ).\n      join();\n     \n    this.featerLayer.definitionExpression = \"GlobalID in (\" + WorkUnitsWhere + \")\";\n    this.featerLayer.when(\n     () => {\n       const query = this.featerLayer.createQuery();\n       query.outSpatialReference = this.mapView.spatialReference;\n       this.featerLayer.queryFeatures().then(response => {\n         response.features.forEach(feature => {\n           const axzz = \"Dfgd\";\n         });\n       });\n       this.featerLayer.queryExtent(query)\n         .then(response => {\n           if (response.extent !== null) this.mapView.goTo(response.extent).catch(function (error) { console.error(error); });\n         });\n\n     });\n  }\n  get workUnits(): string[] {\n    return this._workUnits;\n  }\n\n  public featerLayer: FeatureLayer = new FeatureLayer();\n  public mapView = new MapView();\n  constructor() {\nthis.objectId=\"3453\";\n  }\n  public setworkUnits(workUnits: string[] )\n  {\n     this.workUnits = workUnits;\n  }\n  async initializeMap() {\n    const webMap = new WebMap({\n     basemap: \"topo\",\n     //portalItem: {\n     //  //url:\"https://services2.arcgis.com/utNNrmXb4IZOLXXs/ArcGIS/rest/services/JNFILForest/FeatureServer/0/query\"\n     //  id: \"streets\"\n     //}\n    });\n    let basemap = new Basemap({\n     portalItem: {\n       //url:\"\"\n       id: \"streets\"  // WGS84 Streets Vector webmap\n     }\n    });\n\n    try {\n     this.featerLayer = new FeatureLayer({ url: \"https://services2.arcgis.com/utNNrmXb4IZOLXXs/ArcGIS/rest/services/Test_KKLForestManagementUnits/FeatureServer/0/query\" });\n     this.featerLayer.opacity = 0.5;\n     this.featerLayer.definitionExpression = \"1=2\";\n     //this.featerLayer.displayField = \"FOR_NO\";\n     //this.featerLayer.labelsVisible = true;\n     //this.featerLayer.legendEnabled = true;\n     //this.featerLayer.outFields = [\"FOR_NO\"];\n     //this.featerLayer.popupEnabled = true;\n     const featerRenderer = new SimpleRenderer();\n     featerRenderer.label = \"{FOR_NO}\";\n     const polygonsSimpleFillSymbol = new SimpleFillSymbol();\n     polygonsSimpleFillSymbol.color = Color.fromString(\"gold\");\n     polygonsSimpleFillSymbol.outline.color = Color.fromString(\"blue\");\n     polygonsSimpleFillSymbol.outline.width = 2;\n     featerRenderer.symbol = polygonsSimpleFillSymbol;\n     const labelClass = new LabelClass();\n     labelClass.labelExpressionInfo = { expression: \"$feature.FOR_NO  \" };\n     this.featerLayer.labelingInfo = [labelClass];\n     this.featerLayer.renderer = featerRenderer;\n     webMap.add(this.featerLayer);\n\n\n     this.mapView.container = this.mapViewEl.nativeElement;\n     this.mapView.map = webMap;\n\n\n     //(await mapView.whenLayerView(featerLayer)).filter.where = \"GlobalID = '\" + this._filter[0] + \"'\";\n     //mapView.when(() => {\n     //  this.mapLoaded.emit(true);\n     //});\n    } catch (error) {\n     alert('We have an error: ' + error);\n    }\n\n  }\n\n  ngOnInit() {\n     \n    this.initializeMap();\n  }\n\n}\n","import { CUSTOM_ELEMENTS_SCHEMA, NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { FormsModule } from '@angular/forms';\n\nimport { WorkUnitComponent } from './work-unit.component';\n\n\n\n@NgModule({\n  declarations: [\n    WorkUnitComponent\n  ],\n  imports: [\n    FormsModule,\n    BrowserModule\n  ],         \n  exports: [\n    WorkUnitComponent\n  ],\n  schemas: [ CUSTOM_ELEMENTS_SCHEMA ]\n})\nexport class WorkUnitModule { \n  public set123()\n  {\n\n  }\n}\n","/*\n * Public API Surface of work-unit\n */\n\nexport * from './lib/work-unit.service';\nexport * from './lib/work-unit.component';\nexport * from './lib/work-unit.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}